          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   Navigateur  â”‚
          â”‚   (SPA JS)    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 1ï¸âƒ£ Tape https://localhost:8443
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    Nginx      â”‚
          â”‚  (Reverse     â”‚
          â”‚   Proxy / SSL)â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 2ï¸âƒ£ Handshake TLS / SSL avec le navigateur
                  â”‚    (certificat self-signed)
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   Frontend    â”‚
          â”‚  SPA (HTML+JS)â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 3ï¸âƒ£ Nginx sert le fichier index.html + JS/CSS
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Navigateur    â”‚
          â”‚ Affiche SPA   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 4ï¸âƒ£ Lâ€™utilisateur clique sur /#/login
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Navigateur    â”‚
          â”‚ SPA JS        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 5ï¸âƒ£ fetch('/api/auth/login', { email, password })
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    Nginx      â”‚
          â”‚(Reverse Proxy)â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 6ï¸âƒ£ Transmet la requÃªte POST vers le backend Fastify
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Backend      â”‚
          â”‚  Fastify      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 7ï¸âƒ£ VÃ©rifie email/password via Prisma
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   Prisma ORM  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 8ï¸âƒ£ Convertit JS en SQL
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   SQLite DB   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 9ï¸âƒ£ Renvoie rÃ©sultat utilisateur Ã  Prisma
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Backend      â”‚
          â”‚  Fastify      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ ğŸ”Ÿ CrÃ©e JWT (payload={username/email}) si OK
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Nginx        â”‚
          â”‚ Reverse Proxy â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 1ï¸âƒ£ Renvoie token JSON au front
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Front SPA    â”‚
          â”‚  Stocke JWT   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 2ï¸âƒ£ Utilise JWT pour fetch('/api/protected', { headers: { Authorization: "Bearer <token>" } })
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Nginx        â”‚
          â”‚ Reverse Proxy â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ 3ï¸âƒ£ Transmet la requÃªte au backend
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚Backend Fastifyâ”‚
          â”‚ VÃ©rifie JWT   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Points clÃ©s Ã  retenir

Le front SPA gÃ¨re lâ€™affichage et les interactions utilisateur, sans recharger la page.

Les calls API (fetch('/api/...')) sont ce qui communique avec le backend.

Le backend valide les infos, interagit avec la DB via Prisma, puis gÃ©nÃ¨re le JWT.

Le JWT est stockÃ© sur le front et sert de "passeport" pour accÃ©der aux routes protÃ©gÃ©es.

La DB ne connaÃ®t pas le JWT, elle sert juste Ã  vÃ©rifier/consulter les infos utilisateur.

RÃ´les de Nginx dans ce flux

SSL / HTTPS : il gÃ¨re le certificat TLS et chiffre toutes les communications entre le navigateur et le serveur.

Reverse Proxy : il reÃ§oit toutes les requÃªtes (front et API), et redirige :

/ ou /index.html â†’ frontend (fichiers statiques)

/api/... â†’ backend (Fastify)

CORS / Headers : il peut ajouter des headers de sÃ©curitÃ© ou autoriser certaines origines si nÃ©cessaire.

ğŸ’¡ ConcrÃ¨tement, le front et le back ne sont jamais exposÃ©s directement au navigateurâ€¯: Nginx joue le rÃ´le dâ€™intermÃ©diaire et de filtre.